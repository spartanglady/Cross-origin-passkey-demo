<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Keysmith | Custom Mechanical Keyboards</title>

  <!-- Premium Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
    rel="stylesheet">

  <link rel="stylesheet" href="css/style.css">

  <!-- Load Configuration & PassWallet SDK -->
  <script>
    window.__CONFIG__ = { WALLET_ORIGIN: '' };
    fetch('/api/config')
      .then(r => r.json())
      .then(c => {
        if (c.WALLET_ORIGIN) {
          window.__CONFIG__.WALLET_ORIGIN = c.WALLET_ORIGIN;
          const script = document.createElement('script');
          script.src = `${c.WALLET_ORIGIN}/sdk.js`;
          document.head.appendChild(script);
        }
      }).catch(console.error);
  </script>
</head>

<body>

  <!-- PAGE 1: Storefront View -->
  <div id="storefront-view" class="page-view active">
    <header class="navbar">
      <div class="nav-container">
        <a href="#" class="brand">KEYSMITH.</a>
        <nav class="nav-links">
          <a href="#collection">Collection</a>
          <a href="#about">About</a>
        </nav>
        <div class="nav-actions">
          <button id="cart-toggle" aria-label="Open cart">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
              <line x1="3" y1="6" x2="21" y2="6"></line>
              <path d="M16 10a4 4 0 0 1-8 0"></path>
            </svg>
            <span class="cart-badge" id="cart-count">0</span>
          </button>
        </div>
      </div>
    </header>

    <main>
      <section class="hero">
        <div class="hero-content">
          <h1>Engineered for feeling.<br>Designed for focus.</h1>
          <p>Premium custom mechanical keyboards built with aerospace-grade aluminum and meticulously tuned acoustics.
          </p>
          <button class="btn-primary"
            onclick="document.getElementById('collection').scrollIntoView({behavior: 'smooth'})">Explore
            Collection</button>
        </div>
      </section>

      <section id="collection" class="catalog">
        <div class="catalog-header">
          <h2>The Collection</h2>
        </div>

        <div class="product-grid" id="product-grid">
          <!-- Keeb 1 -->
          <article class="card" data-id="kb-1" data-name="Keysmith 65 - Onyx" data-price="349.00">
            <div class="card-image bg-onyx"></div>
            <div class="card-info">
              <div class="card-row">
                <h3>Keysmith 65</h3>
                <span class="price">$349.00</span>
              </div>
              <p class="specs">Onyx Black • Gasket Mount • Hotswap</p>
              <button class="add-to-cart-btn btn-secondary">Add to Cart</button>
            </div>
          </article>

          <!-- Keeb 2 -->
          <article class="card" data-id="kb-2" data-name="Keysmith 75 - Glacier" data-price="419.00">
            <div class="card-image bg-glacier"></div>
            <div class="card-info">
              <div class="card-row">
                <h3>Keysmith 75</h3>
                <span class="price">$419.00</span>
              </div>
              <p class="specs">Glacier White • Top Mount • Solder</p>
              <button class="add-to-cart-btn btn-secondary">Add to Cart</button>
            </div>
          </article>

          <!-- Keeb 3 -->
          <article class="card" data-id="kb-3" data-name="Keysmith TKL - Raw" data-price="489.00">
            <div class="card-image bg-raw"></div>
            <div class="card-info">
              <div class="card-row">
                <h3>Keysmith TKL</h3>
                <span class="price">$489.00</span>
              </div>
              <p class="specs">Raw Aluminum • O-Ring Mount • Hotswap</p>
              <button class="add-to-cart-btn btn-secondary">Add to Cart</button>
            </div>
          </article>
        </div>
      </section>
    </main>

    <footer class="footer">
      <div class="footer-content">
        <div class="brand">KEYSMITH.</div>
        <p class="copyright">&copy; 2026 Keysmith Industries. All rights reserved.</p>
      </div>
    </footer>
  </div> <!-- End Storefront View -->

  <!-- Drawer Cart -->
  <div id="cart-overlay" class="overlay"></div>
  <aside id="cart-drawer" class="drawer">
    <div class="drawer-header">
      <h2>Your Cart</h2>
      <button id="close-cart-btn" class="close-btn" aria-label="Close cart">&times;</button>
    </div>

    <div class="cart-items" id="cart-items">
      <p class="empty-msg">Your cart is empty.</p>
    </div>

    <div class="cart-footer">
      <div class="summary-line">
        <span>Subtotal</span>
        <span id="cart-subtotal">$0.00</span>
      </div>
      <div class="summary-line total">
        <span>Total</span>
        <span id="cart-total">$0.00</span>
      </div>

      <button id="start-checkout-btn" class="btn-primary w-full" disabled>Checkout</button>
    </div>
  </aside>

  <!-- PAGE 2: Dedicated Checkout Screen -->
  <div id="checkout-page" class="page-view checkout-page">
    <div class="checkout-layout">
      <!-- Left side: Order Summary & Info -->
      <div class="checkout-summary-pane">
        <button id="back-to-store-btn" class="back-link">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15 18 9 12 15 6"></polyline>
          </svg> Return to cart
        </button>

        <div class="brand checkout-brand">KEYSMITH.</div>
        <h1 class="checkout-total" id="checkout-amount-display">$0.00</h1>

        <div class="checkout-items-list" id="checkout-items-list">
          <!-- Populated by JS -->
        </div>

        <div class="checkout-totals">
          <div class="total-line">
            <span>Subtotal</span>
            <span id="checkout-subtotal">$0.00</span>
          </div>
          <div class="total-line">
            <span>Shipping</span>
            <span>Free</span>
          </div>
          <div class="total-line grand-total">
            <span>Total</span>
            <span id="checkout-grand-total">$0.00</span>
          </div>
        </div>
      </div>

      <!-- Right side: Payment (PassWallet) -->
      <div class="checkout-payment-pane">
        <div class="payment-container">
          <h2>Express Checkout</h2>
          <p class="payment-subtitle">Fast, secure checkout via PassWallet.</p>

          <!-- The container where PassWalletSDK will mount the iframe -->
          <div id="passwallet-mount-point" class="wallet-container"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Success Modal -->
  <dialog id="success-modal" class="modal">
    <div class="modal-content">
      <div class="success-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
          stroke-linejoin="round">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
          <polyline points="22 4 12 14.01 9 11.01"></polyline>
        </svg>
      </div>
      <h2>Order Confirmed</h2>
      <p>Your payment was successful. We'll start building your board soon.</p>
      <div class="receipt">
        <div class="receipt-row">
          <span>Amount paid</span>
          <span id="conf-amount">$0.00</span>
        </div>
        <div class="receipt-row">
          <span>Payment method</span>
          <span id="conf-card">•••• 1234</span>
        </div>
      </div>
      <form method="dialog">
        <button class="btn-primary w-full mt-4" onclick="window.location.reload()">Continue Shopping</button>
      </form>
    </div>
  </dialog>

  <script src="app.js"></script>
</body>

</html>